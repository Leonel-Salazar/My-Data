---
title: "Project"
author: "Joaquin Leo, and Seth"
format: docx
---



https://medium.com/analytics-vidhya/titanic-dataset-analysis-80-accuracy-9480cf3db538

```{r}
# Loading the Titanic dataset
titanic_data <- read.csv("Titanic-Dataset.csv")
# Check if the missing data has been replaced
colSums(is.na(titanic_data))
```

```{r}
# Replace missing Age, Cabin, and Embarked with 'Unknown'
titanic_data$Age[is.na(titanic_data$Age)] <- "Age N/A"
titanic_data$Cabin[is.na(titanic_data$Cabin)] <- "Unknown"
titanic_data$Embarked[is.na(titanic_data$Embarked)] <- "Unknown Location"

# Check if the missing data has been replaced
colSums(is.na(titanic_data))
```

```{r}
print('titanic_data')
```

We replaced missing values for Age, Cabin, and Embarked with "Unknown", because we didn't want to drop rows or impute values. This helps preserve all observations. The "Unknown" category will be treated as a factor (categorical variable), and this can be helpful for the model since it acknowledges that these values are missing and could be important.



# Predicting Survival on the Titanic

**Hypothesis:**

Can we accurately predict who was more likely to survive based on available data, such as age, gender, ticket class, and family status?

**Importance of the Analysis**

Understanding survival patterns is crucial because:

-   It provides insight into human behavior during disasters.

-   It highlights how socio-economic status, family ties, and demographic factors (e.g., age, gender) influenced survival odds.

-   It allows us to quantify and statistically validate these patterns through a predictive model.

-   On a broader scale, predictive models like this can inform modern emergency planning, policy making, and historical research.

**Objective:**

Our goal is to build a strong logistic regression classification model that predicts whether a passenger survived or not, based on key attributes. We will also address missing data, test model assumptions, evaluate performance with a confusion matrix, and interpret the model to understand the most influential survival factors.

# Dataset Description: Titanic Survival Dataset

This dataset is based on the historical event of the RMS Titanic disaster, where the ship sank on April 15, 1912, after colliding with an iceberg during its voyage. Of the 2,224 passengers and crew aboard, 1,502 lost their lives.\
The dataset captures a variety of personal and ticket information for Titanic passengers, and the goal is to predict survival outcomes based on these features.

## Data Source

-   Kaggle: [Titanic Survival Prediction Dataset](https://www.kaggle.com/datasets/yasserh/titanic-dataset)

## Dataset Overview

```{r}
# Set seed for reproducibility
set.seed(123) 

# Load necessary libraries
library(caret)

# Create a 70/30 train-test split
split_index <- createDataPartition(titanic_data$Survived, p = 0.7, list = FALSE)
train_data <- titanic_data[split_index, ]
test_data  <- titanic_data[-split_index, ]
```

The data is split into two groups: - **Training Set (`train.csv`)**: Contains both the passenger information and the survival outcomes (target variable). - **Test Set (`test.csv`)**: Contains only the passenger information; the goal is to predict survival outcomes for this set.

------------------------------------------------------------------------

## Variables and Definitions

| Variable   | Definition                                        | Key/Notes                                                             |
|:-----------------|:----------------------------------|:-----------------|
| `Survived` | Survival outcome                                  | 0 = No, 1 = Yes                                                       |
| `Pclass`   | Passenger class (proxy for socio-economic status) | 1 = 1st (Upper), 2 = 2nd (Middle), 3 = 3rd (Lower)                    |
| `Sex`      | Gender of the passenger                           | Male, Female                                                          |
| `Age`      | Age of the passenger in years                     | Fractions for infants (\<1 year); some values estimated (xx.5 format) |
| `SibSp`    | Number of siblings/spouses aboard                 | Includes step-relations                                               |
| `Parch`    | Number of parents/children aboard                 | Includes step-relations                                               |
| `Ticket`   | Ticket number                                     | May have duplicates                                                   |
| `Fare`     | Passenger fare                                    | Continuous variable                                                   |
| `Cabin`    | Cabin number                                      | Many missing entries                                                  |
| `Embarked` | Port of Embarkation                               | C = Cherbourg, Q = Queenstown, S = Southampton                        |

------------------------------------------------------------------------

## Notes on Key Variables

-   `Pclass` is a significant proxy for socio-economic status, which may influence survival likelihood.
-   `SibSp` and `Parch` help capture family structures aboard the ship.
-   `Cabin` contains many missing values, which may require special handling.
-   `Embarked` may show port-based survival differences.



#Assumptions Check (for Logistic Regression)

Linearity of log-odds with numeric predictors

No multicollinearity (use VIF check if you want)

Independence of observations

Not necessary to check normality or homoscedasticity for logistic regression!

## Step-by-Step Analysis

### Fit the logistic regression model

```{r}
# Fit the logistic regression model
model <- glm(Survived ~ Pclass + Sex + Age + SibSp + Parch + Fare + Embarked, 
             data = train_data, family = "binomial")

# Summary of the model
summary(model)
```

## Explain the coefficients Interpret odds ratios:

```{r}
# Calculate and interpret the odds ratios (exponentiate coefficients)
exp(coef(model))
```

## Confusion Matrix: Predicting Survival and Comparing Predicted vs Actual


```{r}
# Make predictions on the training set
predictions <- ifelse(predict(model, type = "response") > 0.5, 1, 0)

# Create confusion matrix
library(caret)
confusionMatrix(as.factor(predictions), as.factor(train_data$Survived))
```

## ROC Curve and AUC

```{r}
# Load necessary library for ROC curve
library(pROC)

# Create the ROC curve
roc_curve <- roc(train_data$Survived, predict(model, type = "response"))

# Plot ROC curve
plot(roc_curve)

# Calculate AUC
auc(roc_curve)
```


## Evaluate on Test Data

```{r}
# Ensure factor levels for 'Age' match between train and test data
test_data$Age <- factor(test_data$Age, levels = levels(train_data$Age))
test_data$Embarked <- factor(test_data$Embarked, levels = levels(train_data$Embarked))


# Ensure both predicted and actual levels are the same
test_predictions <- factor(test_predictions, levels = levels(train_data$Survived))

# Create confusion matrix for the test set
confusionMatrix(test_predictions, as.factor(test_data$Survived))
```

Conclusion and Interpretation
Interpret the model output, especially the significance of the coefficients.

Discuss how well the model predicts survival on the Titanic using the test data.

Explore potential improvements, such as feature engineering or trying different modeling approaches, if necessary.

